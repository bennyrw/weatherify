(this.webpackJsonpweatherify=this.webpackJsonpweatherify||[]).push([[0],{74:function(e,t,a){e.exports=a(86)},86:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(13),o=a.n(c),i=a(22),s=a(28),l=a(62),u=a(126),p=a(124),m=a(132),f=a(49),d=a(123),g=a(131),h=a(133),b=a(61),E=a.n(b),y=a(60),v=a.n(y);function w(e){return{type:"FETCH_FORECAST_FAILED",payload:{errorKey:e}}}var x=Object(p.a)((function(e){return{search:{marginTop:e.spacing(2),display:"flex",flexDirection:"row",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.primary.main},form:{display:"flex",flexDirection:"row",width:"100%",marginTop:e.spacing(3)},location:{},submit:{margin:e.spacing(0,1)}}}));var O=Object(i.b)((function(e){return{location:e.location}}),(function(e){return{onSetLocation:function(t){return e(function(e){return{type:"SET_LOCATION",payload:{location:e}}}(t))},onSearch:function(){return e({type:"FETCH_FORECAST"})}}}))((function(e){var t=n.a.useState(e.location||""),a=Object(f.a)(t,2),r=a[0],c=a[1],o=Boolean(r),i=x();return n.a.createElement("div",{className:i.search},n.a.createElement("form",{className:i.form,onSubmit:function(t){t.preventDefault(),e.onSetLocation(r),e.onSearch()}},n.a.createElement(h.a,{className:i.avatar},n.a.createElement(v.a,{fontSize:"large",titleAccess:"enter location"})),n.a.createElement(g.a,{className:i.location,"data-testid":"search-location",name:"location",variant:"outlined",required:!0,fullWidth:!0,autoFocus:!0,onChange:function(e){c(e.target.value)},value:r}),n.a.createElement(d.a,{className:i.submit,"data-testid":"search-button",variant:"contained",color:"primary",type:"submit",disabled:!o},n.a.createElement(E.a,{titleAccess:"search"}))))})),C=a(125);var j=function(){return n.a.createElement(C.a,null)},F=a(130),I=a(127),S=a(135),D=a(128),T=a(134);function A(e){var t=e.useCentigrade,a=e.onToggleUnits,r=t?"\xb0C":"\xb0F";return n.a.createElement(I.a,{item:!0,xs:12},n.a.createElement(I.a,{component:"label",container:!0,alignItems:"center",spacing:1},n.a.createElement(I.a,{item:!0},n.a.createElement(T.a,{checked:t,onChange:function(e){var t=e.target.checked;a(t)}})),n.a.createElement(I.a,{item:!0},n.a.createElement(D.a,null,r))))}var M=Object(i.b)((function(e){return{forecast:e.forecast,forecastDayIndex:e.forecastDayIndex,useCentigrade:e.useCentigrade}}),(function(e){return{onToggleUnits:function(t){return e({type:"CHANGE_UNITS",payload:{isCentigrade:t}})}}}))((function(e){var t=e.isSmallScreen,a=e.forecast,r=e.forecastDayIndex,c=e.useCentigrade;if(!a)return null;var o=a.dailyWeather.get(r),i=function(e){return Math.round(10*e)/10},s=i(c?o.temperatureInCentigrade:9*o.temperatureInCentigrade/5+32),l="".concat(o.pressureInMillibars," mB");return n.a.createElement(u.a,null,n.a.createElement(I.a,{container:!0},!t&&A(e),n.a.createElement(I.a,{item:!0,xs:t?6:12},n.a.createElement(I.a,{container:!0,justify:"center"},n.a.createElement("img",{alt:"weather icon",src:o.iconUrl,width:"50%"}))),n.a.createElement(I.a,{item:!0,xs:t?6:12},n.a.createElement(I.a,{container:!0,justify:"center",alignItems:"center",spacing:3,direction:t?"column":"row"},n.a.createElement(I.a,{item:!0},n.a.createElement(D.a,null,s," ",c?"\xb0C":"\xb0F")),n.a.createElement(I.a,{item:!0},n.a.createElement(D.a,null,l)),t&&A(e)))))})),N=!1,U=!1,_=!1,k={"en-GB":{"fetch-general-error":"A problem occurred. Please try again.","fetch-location-not-found":"Sorry, we couldn't find that location. Please try again.",now:"Now"}},H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-GB";return k[t]&&k[t][e]};function R(e,t){var a=e.forecast,r=e.forecastDayIndex,c=e.onChangeDay,o=a.dailyWeather,i=0,s=o.map((function(e){var t=0===i?H("now"):e.date.toLocaleString("en-GB",{weekday:"short"});return{value:i++,label:n.a.createElement(D.a,null,t)}}));return n.a.createElement(S.a,{className:t.slider,"aria-label":"change day",marks:s.toArray(),min:0,max:o.size-1,onChange:function(e,t){var a=t instanceof Array?t[0]:t;c(a)},value:r})}var L=Object(p.a)((function(e){return{map:{display:"flex",justifyContent:"center"},slider:{marginTop:e.spacing(3),marginBottom:e.spacing(6)}}}));var K=Object(i.b)((function(e){return{forecast:e.forecast,forecastDayIndex:e.forecastDayIndex}}),(function(e){return{onChangeDay:function(t){return e(function(e){return{type:"CHANGE_DAY",payload:{daysInFuture:e}}}(t))}}}))((function(e){var t=e.forecast,a=!Object(F.a)("(min-width:800px)"),r=L();if(!t)return null;var c=a?"50%":"100%",o=n.a.createElement("div",{className:r.map},n.a.createElement("img",{alt:"location map",src:t.locationMapUrl,width:c}));return a?n.a.createElement(u.a,null,n.a.createElement(M,{isSmallScreen:a}),R(e,r),o):n.a.createElement(u.a,null,n.a.createElement(I.a,{container:!0,justify:"center",direction:"row"},n.a.createElement(I.a,{item:!0,xs:6},o),n.a.createElement(I.a,{item:!0,xs:6},n.a.createElement(M,{isSmallScreen:a}))),R(e,r))}));var B=Object(p.a)((function(e){return{resultPanel:{marginTop:e.spacing(4),display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",overflow:"hidden"},error:{marginTop:e.spacing(4)}}}));var G=Object(i.b)((function(e){return{isFetchingForecast:e.isFetchingForecast,forecast:e.forecast,errorKey:e.errorKey}}))((function(e){var t=e.isFetchingForecast,a=e.forecast,r=e.errorKey,c=B();return n.a.createElement(u.a,{component:"main",maxWidth:"xl"},n.a.createElement(O,null),r&&function(e,t){return n.a.createElement("div",{className:t.error},n.a.createElement(m.a,{severity:"error"},H(e)))}(r,c),n.a.createElement("div",{className:c.resultPanel},t&&n.a.createElement(j,null),!t&&a&&n.a.createElement(K,null)))})),P=a(20),W=a(48);function z(){var e={isFetchingForecast:!1,forecastDayIndex:0,useCentigrade:!0};return N?e.isFetchingForecast=!0:U?(e.location="Cambridge",e.forecast={locationMapUrl:"https://a.tile.openstreetmap.org/12/2049/1349.png",dailyWeather:Object(W.a)([{iconUrl:"http://openweathermap.org/img/wn/10d@2x.png",date:new Date,temperatureInCentigrade:37.5,pressureInMillibars:1023},{iconUrl:"http://openweathermap.org/img/wn/01d@2x.png",date:new Date(Date.now()+864e5),temperatureInCentigrade:21,pressureInMillibars:1e3},{iconUrl:"http://openweathermap.org/img/wn/04d@2x.png",date:new Date(Date.now()+1728e5),temperatureInCentigrade:14.5,pressureInMillibars:980}])}):_&&(e.errorKey="fetch-general-error"),e}var q=a(19),J=a.n(q),Y=a(23),Q=a(34);function V(e){return X.apply(this,arguments)}function X(){return(X=Object(Q.a)(J.a.mark((function e(t){var a,r,n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(Z(t));case 3:return r=e.sent,e.next=6,r.json();case 6:if(1!==(n=e.sent).length){e.next=11;break}return e.abrupt("return",{longitude:Number(n[0].lon),latitude:Number(n[0].lat)});case 11:return e.abrupt("return",null);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),a=e.t0.message;case 17:throw new Error("Failed to find coordinates for location ".concat(t).concat(a?", error: "+a:""));case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}var Z=function(e){return"https://nominatim.openstreetmap.org/search?q=".concat(encodeURI(e),"&format=json&limit=1")};function $(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(Q.a)(J.a.mark((function e(t,a){var r,n,c,o,i,s;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=ae(t,a,12),n=r.x,c=r.y,o=r.z,e.next=4,fetch(te(n,c,o));case 4:return i=e.sent,e.next=7,i.blob();case 7:return s=e.sent,e.abrupt("return",URL.createObjectURL(s));case 11:throw e.prev=11,e.t0=e.catch(0),new Error("Error occurred getting location map: ".concat(e.t0.message));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}var te=function(e,t,a){return"https://a.tile.openstreetmap.org/".concat(a,"/").concat(e,"/").concat(t,".png")};function ae(e,t,a){return{x:re(e,a),y:ne(t,a),z:a}}function re(e,t){return Math.floor((e+180)/360*Math.pow(2,t))}function ne(e,t){return Math.floor((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}function ce(e,t,a){return oe.apply(this,arguments)}function oe(){return(oe=Object(Q.a)(J.a.mark((function e(t,a,r){var n,c,o;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(le(t,a));case 3:return n=e.sent,e.next=6,n.json();case 6:return c=e.sent,o=c.daily,e.abrupt("return",Object(W.a)(o.slice(0,r).map(ie)));case 11:throw e.prev=11,e.t0=e.catch(0),new Error("Failed to get weather for location, error: ".concat(e.t0.message));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function ie(e){return{iconUrl:se(e.weather[0].icon),date:new Date(1e3*e.dt),temperatureInCentigrade:e.temp.day,pressureInMillibars:e.pressure}}var se=function(e){return"http://openweathermap.org/img/wn/".concat(e,"@2x.png")},le=function(e,t){return"https://api.openweathermap.org/data/2.5/onecall?lat=".concat(t,"&lon=").concat(e,"&units=metric&appid=").concat("e56d308d4e223c8749d63fe32d8b8442")},ue=J.a.mark(me),pe=J.a.mark(de);function me(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Y.e)("FETCH_FORECAST",de);case 2:case"end":return e.stop()}}),ue)}var fe=function(e){return e.location};function de(){var e,t,a,r,n,c,o,i;return J.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,Object(Y.d)(fe);case 3:return e=s.sent,s.next=6,Object(Y.b)(V,e);case 6:if(t=s.sent){s.next=11;break}return s.next=10,Object(Y.c)(w("fetch-location-not-found"));case 10:return s.abrupt("return",s.sent);case 11:return a=t.longitude,r=t.latitude,s.next=14,Object(Y.a)([Object(Y.b)($,a,r),Object(Y.b)(ce,a,r,4)]);case 14:return n=s.sent,c=Object(f.a)(n,2),o=c[0],i=c[1],s.next=20,Object(Y.c)({type:"FETCH_FORECAST_SUCCEEDED",payload:{forecast:{locationMapUrl:o,dailyWeather:i}}});case 20:return s.abrupt("return",s.sent);case 23:return s.prev=23,s.t0=s.catch(0),console.error(s.t0.message),s.next=28,Object(Y.c)(w("fetch-general-error"));case 28:return s.abrupt("return",s.sent);case 29:case"end":return s.stop()}}),pe,null,[[0,23]])}var ge=Object(l.a)(),he=z(),be=Object(s.d)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOCATION":var a=t,r=a.payload.location;return Object(P.a)(Object(P.a)({},e),{},{location:r});case"FETCH_FORECAST":return e.location?Object(P.a)(Object(P.a)({},e),{},{isFetchingForecast:!0,errorKey:void 0}):e;case"FETCH_FORECAST_SUCCEEDED":var n=t,c=n.payload.forecast;return Object(P.a)(Object(P.a)({},e),{},{isFetchingForecast:!1,forecast:c});case"FETCH_FORECAST_FAILED":var o=t,i=o.payload.errorKey;return Object(P.a)(Object(P.a)({},e),{},{isFetchingForecast:!1,errorKey:i,forecast:void 0});case"CHANGE_DAY":var s=t,l=s.payload.daysInFuture;return Object(P.a)(Object(P.a)({},e),{},{forecastDayIndex:l});case"CHANGE_UNITS":var u=t,p=u.payload.isCentigrade;return Object(P.a)(Object(P.a)({},e),{},{useCentigrade:p})}return e}),he,Object(s.a)(ge));o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(i.a,{store:be},n.a.createElement(G,null))),document.getElementById("root")),ge.run(me)}},[[74,1,2]]]);
//# sourceMappingURL=main.efb604f7.chunk.js.map